<!DOCTYPE html>
<html lang="en" translate="no">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="ViernesForm.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <title>ViernesForm</title>

</head>

<body>
    <div class="Contendor" id="Contendor">
        <div class="LineraHorizontal">
            <img src="Captura desde 2025-08-24 17-20-22.png" alt="" width="100%" height="100%">
        </div>
        <div class="Encabezado">
            <div class="Encabezados">
                <img src="Logo.png" alt="">

            </div>
            <div class="NombreIglesia">
                <h1 class="Name">FILADELFIA</h1>
            </div>



            <div class="Listado">

            </div>


        </div>

    </div>
      <button id="Descarga">Descargar</button>
         <a href="/index.html" ><button id="Descarga">Principal</button></a>
</body>
<script>
const TrimestreJson = localStorage.getItem('Trimestre');
const DiasJson = localStorage.getItem('DiasPredicacion');
const PredicDisp = localStorage.getItem('PredicadoresDisp');
const Trimestre = JSON.parse(TrimestreJson);
const DiasDisponibles = JSON.parse(DiasJson);
const PredicadoresDispo = JSON.parse(PredicDisp);

console.log('Días Disponibles:', DiasDisponibles); // Verifica que los datos se estén cargando

let Mes = [];

if (Trimestre == 1) {
    Mes.push('Enero', 'Febrero', 'Marzo');
} else if (Trimestre == 2) {
    Mes.push('Abril', 'Mayo', 'Junio');
} else if (Trimestre == 3) {
    Mes.push('Julio', 'Agosto', 'Septiembre');
} else if (Trimestre == 4) {
    Mes.push('Octubre', 'Noviembre', 'Diciembre');
}

const listado = document.querySelector(".Listado");

let ultimoDia = 0; // Almacena el último día procesado
let mesActualIndex = 0; // Índice del mes actual

// Creamos el primer mes antes de iniciar el bucle
let divMes = document.createElement("div");
divMes.className = "Mes";
let aMes = document.createElement("a");
aMes.className = "MesesId";
aMes.textContent = Mes[mesActualIndex];
divMes.appendChild(aMes);

// Recorre cada día disponible
for (let i = 0; i < DiasDisponibles.length; i++) {
    const diaActual = DiasDisponibles[i];

    // Lógica para detectar el cambio de mes
    // Si el día actual es menor que el último día, es un nuevo mes
    if (diaActual < ultimoDia) {
        // Agrega el div del mes anterior a la lista
        listado.appendChild(divMes);

        // Pasa al siguiente mes
        mesActualIndex++;

        // Crea un nuevo div para el siguiente mes
        divMes = document.createElement("div");
        divMes.className = "Mes";
        aMes = document.createElement("a");
        aMes.className = "MesesId";
        aMes.textContent = Mes[mesActualIndex];
        divMes.appendChild(aMes);
    }
    
    // Agrega el día actual al div del mes
    const ul = document.createElement("ul");
    ul.className = "idPredict";
    ul.textContent = String(diaActual +`-`+ PredicadoresDispo[i]);
    divMes.appendChild(ul);
    
    // Actualiza el último día para la siguiente iteración
    ultimoDia = diaActual;
}

// Agrega el último mes a la lista al finalizar el bucle
listado.appendChild(divMes);

 const Contenido = document.getElementById('Contendor');
        const GenerarPdf = document.getElementById('Descarga');
        GenerarPdf.addEventListener('click', function(){
            const opciones = {
                    scale: 2,
                    useCORS:true
                };

                html2canvas(Contenido,opciones).then(function(canvas){
                    const ImgUrl = canvas.toDataURL('image/png');

                    const enlace = document.createElement('a');
                    enlace.href = ImgUrl;
                    enlace.download = 'Viernes.png';
                    document.body.appendChild(enlace);

                    enlace.click();
                    document.body.removeChild(enlace);
                })
        })
</script>

</html>